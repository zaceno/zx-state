{"version":3,"file":"zx-app.umd.js","sources":["../src/index.js"],"sourcesContent":["function mapObj(orig, fn, onto) {\n    return Object.keys((orig || {})).reduce((o, name) => {\n      o[name] = fn(orig[name], name, o)\n      return o\n    }, (onto ||Â {}))\n  } \n  \n  function bindFnCollection(binder, collection, ...more) {\n    return mapObj(collection, (toBind, name, bound) => {\n      if (typeof toBind === 'function') return binder(toBind, bound, ...more)\n      return bindFnCollection(binder, toBind, ...more.map(x => x[name]))\n    })\n  }\n  \n  function collectSubs(opts, prop) {\n    return mapObj(opts.sub, sub => Object.assign({}, collectSubs(sub, prop)), opts[prop])\n  }\n  \n  function onceNextTick (fn) {\n    var pending;\n    return _ => {\n      if (pending) return\n      pending = !pending\n      setTimeout(_ => {\n        pending = !pending\n        fn()\n      }, 0)\n    }\n  }\n  \n  function curriedCaller (fn, bound, ...more) {\n    return  function (...args) {\n      var ret = fn(...more, bound)\n      if (typeof ret === 'function') ret = ret(...args)\n      return ret\n    }\n  }\n  \n  function actionCaller (update) {\n    return function (action, actions, state) {\n      var caller = curriedCaller(action, actions, state)\n      return  function (...args) {\n        var ret = caller(...args)\n        if (!ret) return\n        Object.assign(state, ret)\n        update()\n      }\n    }\n  }\n  \n  \n  export default function (opts, notify) {\n    const update = onceNextTick(notify || (_ => {})) \n    const state = collectSubs(opts, 'state')\n    const actions = bindFnCollection(actionCaller(update), collectSubs(opts, 'actions'), state)\n    const views = bindFnCollection(curriedCaller, collectSubs(opts, 'views'), state, actions)\n    update()\n    return {actions, views}\n  }"],"names":["mapObj","orig","fn","onto","Object","keys","reduce","o","name","bindFnCollection","binder","collection","more","toBind","bound","map","x","collectSubs","opts","prop","sub","assign","curriedCaller","args","ret","notify","update","pending","_","setTimeout","onceNextTick","state","actions","action","caller","actionCaller","views"],"mappings":"oCAAA,SAASA,EAAOC,EAAMC,EAAIC,GACtB,OAAOC,OAAOC,KAAMJ,OAAaK,OAAO,CAACC,EAAGC,KAC1CD,EAAEC,GAAQN,EAAGD,EAAKO,GAAOA,EAAMD,GACxBA,GACLJ,OAGN,SAASM,EAAiBC,EAAQC,KAAeC,GAC/C,OAAOZ,EAAOW,EAAY,CAACE,EAAQL,EAAMM,IACjB,mBAAXD,EAA8BH,EAAOG,EAAQC,KAAUF,GAC3DH,EAAiBC,EAAQG,KAAWD,EAAKG,IAAIC,GAAKA,EAAER,MAI/D,SAASS,EAAYC,EAAMC,GACzB,OAAOnB,EAAOkB,EAAKE,IAAKA,GAAOhB,OAAOiB,UAAWJ,EAAYG,EAAKD,IAAQD,EAAKC,IAejF,SAASG,EAAepB,EAAIY,KAAUF,GACpC,OAAQ,YAAaW,GACnB,IAAIC,EAAMtB,KAAMU,EAAME,GAEtB,MADmB,mBAARU,IAAoBA,EAAMA,KAAOD,IACrCC,UAiBI,SAAUN,EAAMO,GAC7B,MAAMC,EAlCR,SAAuBxB,GACrB,IAAIyB,EACJ,OAAOC,IACDD,IACJA,GAAWA,EACXE,WAAWD,IACTD,GAAWA,EACXzB,KACC,KA0BU4B,CAAaL,IAAWG,QACjCG,EAAQd,EAAYC,EAAM,SAC1Bc,EAAUvB,EAhBlB,SAAuBiB,GACrB,OAAO,SAAUO,EAAQD,EAASD,GAChC,IAAIG,EAASZ,EAAcW,EAAQD,EAASD,GAC5C,OAAQ,YAAaR,GACnB,IAAIC,EAAMU,KAAUX,GACfC,IACLpB,OAAOiB,OAAOU,EAAOP,GACrBE,OAS6BS,CAAaT,GAAST,EAAYC,EAAM,WAAYa,GAC/EK,EAAQ3B,EAAiBa,EAAeL,EAAYC,EAAM,SAAUa,EAAOC,GAEjF,OADAN,KACQM,QAAAA,EAASI,MAAAA"}